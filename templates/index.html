<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinese Name Converter</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: transparent;
            color: #374151;
            line-height: 1.6;
        }

        .widget-container {
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
        }

        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid #f3f4f6;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            color: #6b7280;
        }

        .search-section {
            margin-bottom: 24px;
        }

        .search-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: #374151;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px;
            font-size: 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            outline: none;
            background: #ffffff;
            color: #111827;
        }

        .search-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .gender-selection {
            margin-top: 16px;
        }

        .gender-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: #374151;
        }

        .gender-options {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .gender-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 14px;
            color: #6b7280;
        }

        .gender-option input[type="radio"] {
            margin-right: 6px;
        }

        .results-section {
            min-height: 100px;
        }

        .result-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .result-card.curated {
            border-left: 4px solid #10b981;
        }

        .result-card.phonetic {
            border-left: 4px solid #3b82f6;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 12px;
        }

        .name-original {
            font-size: 18px;
            font-weight: 600;
            color: #111827;
            flex: 1;
        }

        .source-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
        }

        .source-badge.curated {
            background: #d1fae5;
            color: #065f46;
        }

        .source-badge.phonetic {
            background: #dbeafe;
            color: #1e40af;
        }

        .name-chinese {
            font-size: 24px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 8px;
        }

        .name-pronunciation {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 12px;
            font-style: italic;
        }

        .name-meaning {
            font-size: 14px;
            color: #374151;
            line-height: 1.5;
            padding: 8px 12px;
            background: rgba(59, 130, 246, 0.05);
            border-radius: 6px;
            border-left: 3px solid #3b82f6;
        }

        .no-results {
            text-align: center;
            padding: 32px 16px;
            color: #6b7280;
        }

        .loading {
            text-align: center;
            padding: 32px 16px;
            color: #6b7280;
        }

        .stats {
            text-align: center;
            padding: 16px;
            background: #f9fafb;
            border-radius: 8px;
            font-size: 13px;
            color: #6b7280;
            border: 1px solid #f3f4f6;
        }

        .disclaimer {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 6px;
            padding: 12px;
            margin-top: 16px;
            font-size: 12px;
            color: #92400e;
        }

        @media (max-width: 640px) {
            .widget-container {
                padding: 16px;
                margin: 0;
                border-radius: 8px;
            }

            .search-input {
                font-size: 16px;
                padding: 10px 14px;
            }

            .result-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="widget-container">
        <div class="header">
            <h1>Chinese Name Converter</h1>
            <p>Find your Chinese name with authentic translations</p>
        </div>
        
        <div class="search-section">
            <label for="nameInput" class="search-label">Enter your name:</label>
            <input 
                type="text" 
                id="nameInput" 
                class="search-input" 
                placeholder="Type your name here..."
                autocomplete="off"
            >
            
            <div class="gender-selection">
                <label class="gender-label">Gender preference:</label>
                <div class="gender-options">
                    <label class="gender-option">
                        <input type="radio" name="gender" value="female" id="genderFemale">
                        <span>Female</span>
                    </label>
                    <label class="gender-option">
                        <input type="radio" name="gender" value="male" id="genderMale">
                        <span>Male</span>
                    </label>
                    <label class="gender-option">
                        <input type="radio" name="gender" value="neutral" id="genderNeutral" checked>
                        <span>Neutral</span>
                    </label>
                </div>
            </div>
        </div>
        
        <div class="results-section" id="resultsSection">
            <div class="stats" id="statsSection">
                <strong id="totalNames">Loading...</strong> curated names with authentic Chinese translations
            </div>
        </div>

        <div class="disclaimer">
            <strong>Note:</strong> "Curated" names are researched translations. "Phonetic" names are approximations.
        </div>
    </div>

    <script>
        let searchTimeout;
        const nameInput = document.getElementById('nameInput');
        const resultsSection = document.getElementById('resultsSection');
        const totalNamesSpan = document.getElementById('totalNames');

        // Load initial stats
        fetch('/api/stats')
            .then(response => response.json())
            .then(data => {
                totalNamesSpan.textContent = data.total_names;
            })
            .catch(() => {
                totalNamesSpan.textContent = '1000+';
            });

        function displayResults(data) {
            if (!data.results || data.results.length === 0) {
                resultsSection.innerHTML = '<div class="no-results"><p>No matches found for "' + data.query + '".</p><p>Try a different spelling or shorter version.</p></div>';
                return;
            }

            const resultsHTML = data.results.map(result => {
                const sourceClass = result.source === 'curated' ? 'curated' : 'phonetic';
                const sourceBadge = result.source === 'curated' ? 'Curated' : 'Phonetic';
                
                return '<div class="result-card ' + sourceClass + '">' +
                    '<div class="result-header">' +
                        '<div class="name-original">' + result.name + '</div>' +
                        '<div class="source-badge ' + sourceClass + '">' + sourceBadge + '</div>' +
                    '</div>' +
                    '<div class="name-chinese">' + result.chinese + '</div>' +
                    '<div class="name-pronunciation">' + result.pinyin + '</div>' +
                    '<div class="name-meaning"><strong>Meaning:</strong> ' + result.meaning + '</div>' +
                '</div>';
            }).join('');

            resultsSection.innerHTML = resultsHTML;
        }

        function displayLoading() {
            resultsSection.innerHTML = '<div class="loading"><span>Searching names...</span></div>';
        }

        function handleSearch() {
            const query = nameInput.value.trim();
            const gender = document.querySelector('input[name="gender"]:checked').value;
            
            if (!query) {
                resultsSection.innerHTML = '<div class="stats"><strong>' + totalNamesSpan.textContent + '</strong> curated names with authentic Chinese translations</div>';
                return;
            }

            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                displayLoading();
                
                fetch('/api/search?q=' + encodeURIComponent(query) + '&gender=' + gender + '&limit=5')
                    .then(response => response.json())
                    .then(data => {
                        if (data.error) {
                            throw new Error(data.error);
                        }
                        displayResults(data);
                    })
                    .catch(error => {
                        resultsSection.innerHTML = '<div class="no-results"><p>Error searching names.</p><p>Please try again in a moment.</p></div>';
                        console.error('Search error:', error);
                    });
            }, 300);
        }

        // Event listeners
        nameInput.addEventListener('input', handleSearch);
        nameInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                handleSearch();
            }
        });

        // Handle gender change
        document.querySelectorAll('input[name="gender"]').forEach(radio => {
            radio.addEventListener('change', handleSearch);
        });
    </script>
</body>
</html>
